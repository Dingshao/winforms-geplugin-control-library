#summary Using the WalkKmlDom method
#sidebar TableOfContents

<wiki:toc max_depth="2" />

= Introduction =

The method can be used to iterate over a KML DOM calling the specifed method on each node.

This method is based on the function of the same name the !KmlDomWalk.js file: http://code.google.com/p/earth-api-samples/source/browse/trunk/lib/kmldomwalk.js

== Syntax ==

{{{
/// <summary>
/// Walks a KML object, calling a given visit function for each object in the KML DOM.
/// </summary>
/// <param name="kmlObject">The kml object to parse</param>
/// <param name="callBack">A WalkKmlDomCallBack delegate method to call on each node visited</param>
public static void WalkKmlDom(dynamic kmlObject, CallBack callBack)
}}}

== Examples ==

This example shows how to use the WalkKmlDom method and the WalkKmlDomCallBack delegate to iterate over a Kml Dom.

{{{
public partial class Form1 : Form
{
    dynamic ge = null;

    internal void MyDeleagate(dynamic kmlObject)
    {
       // Displays the type of each object in the DOM
       MessageBox.Show("Type:" + kmlObject.getType());
    }

    public Form1()
    {
        InitializeComponent();

        // load the plugin
        geWebBrowser1.LoadEmbededPlugin();

        // set the ready event handler
        geWebBrowser1.PluginReady += new FC.GEPluginCtrls.GEWebBrowserEventHandler(geWebBrowser1_PluginReady);

        // set the kml load event handler
        geWebBrowser1.KmlLoaded += new GEWebBrowserEventHandler(geWebBrowser1_KmlLoaded);
        KmlHelpers.WalkKmlDomCallBack MyDeleagate = new KmlHelpers.WalkKmlDomCallBack(WalkKmlDomCallback);
    }

    void geWebBrowser1_PluginReady(object sender, FC.GEPluginCtrls.GEEventArgs e)
    {
        // ge is the GEPlugin COM object that can now be used
        // exactly as you would in the native api.
        ge = geWebBrowser1.GetPlugin();

        // load a kml file
        geWebBrowser1.FetchKml("http://www.host.com/file.kml");
    }

    void geWebBrowser1_KmlLoaded(object sender, GEEventArgs e)
    {
        // Iterate over the loaded KML DOM
        KmlHelpers.WalkKmlDom(sender, WalkKmlDomCallback);
    }
}
}}}

== Remarks ===

<wiki:gadget url="http://earthapi.googlepages.com/ad.xml" border="0" width="728" height="90" />