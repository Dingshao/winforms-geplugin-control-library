#summary A simple winform example
#labels Featured,Phase-Implementation

= Introduction =

This form shows the most basic set up of the GEWebBrowser with the local server, there are no other controls added.

= Details =

Here the plugin behaves exactly as it would with the default set-up in a web page.  The local server is used to deliver files (kml, kmz, images) to the plugin. This overcomes all of the security restrictions when using parts of the javasctipt api with the local file system.

{{{
namespace WindowsFormsApplication1
{
    using System;
    using System.Windows.Forms;
    using FC.GEPluginCtrls;
    using FC.GEPluginCtrls.HttpServer;

    public partial class Form1 : Form
    {
        private dynamic ge = null;

        /// <summary>
        /// By default the server uses the "application root directory" as its root directory
        /// It listens on port 8080 for incomming connections from the Google Earth plugn client.
        /// The default file name is default.kml
        /// These can all be set via the server's properties
        /// Here we set the directory to "webroot"
        /// </summary>
        private Server server = new Server("webroot");

        public Form1()
        {
            InitializeComponent();

            // set the root directory, port, ip address and if desired...
            //server.RootDirectory = "somefolder";
            //server.Port = 80;
            //server.DefaultFileName = "index.kml";
            //server.IPAddress = System.Net.IPAddress.Any;
            
            // start the server
            server.Start();

            // load the plug-in
            geWebBrowser1.LoadEmbededPlugin();

            // register handlers for the plugin ready and kml loaded events
            geWebBrowser1.PluginReady += new GEWebBrowserEventHandler(geWebBrowser1_PluginReady);
            geWebBrowser1.KmlLoaded += new GEWebBrowserEventHandler(geWebBrowser1_KmlLoaded);

            // stop the server when the form is closing...
            this.FormClosing += new FormClosingEventHandler(Form1_FormClosing);
        }

        // Handle kml loaded events 
        void geWebBrowser1_KmlLoaded(object sender, GEEventArgs e)
        {
            dynamic kml = sender;

            // show the data in the browser
            geWebBrowser1.ParseKmlObject(kml);
        }

        // Handle the plugin ready event
        void geWebBrowser1_PluginReady(object sender, GEEventArgs e)
        {
            // load a local kml file "./webroot/samples.kml"
            geWebBrowser1.FetchKml("http://localhost:8080/samples.kml");
        }


        // handle the form closing
        void Form1_FormClosing(object sender, FormClosingEventArgs e)
        {
            // Stops the server
            server.Stop();
        }
    }
}
}}}

<wiki:gadget url="http://earthapi.googlepages.com/ad.xml" border="0" width="728" height="90" />