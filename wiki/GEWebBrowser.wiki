#summary GEWebBrowser control notes
#labels Phase-Implementation

http://earthapi.googlepages.com/GEWebBrowser.jpg

= Introduction =

The main control that holds the Google Earth Plugin. All other controls in the library interact with the plugin object hosted in this control.

Key features

  * Load the plugin from a hosted page or from an embeded file in the library
  * Get the current plugin view as a Bitmap
  * Load Kml or Kmz files into the plugin 
  * Inject and invoke Javascript at runtime

= Details =

The GEWebBrowser inherits from the standard [http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.aspx System.Windows.Forms.WebBrowser] control class and has the same base members, methods, properties and events. 

The GEWebBrowser control cannot be used by partially trusted code. For more information, see [http://msdn.microsoft.com/en-us/library/8skskf63.aspx Using Libraries from Partially Trusted Code]

== Public Properties ==

_ImageryBase_ *ImageryBase*<br>
Gets or sets a value indicating the current plug-in imagery base<br>

_Bool_ *PluginIsReady*<br>
Gets a value indicating if the plug-in is ready to use<br>

== Public Methods ==

_Void_ *AddEventListener(System.object, System.String)*<br>
Wrapper for the the google.earth.addEventListener method<br>
*Parameters*<br>
object: The target object<br>
string: The event Id<br>

_IGEPlugin_ *GetPlugin()*<br>
Get the plugin instance associated with the control<br>
*Return Value:* The plugin instance

_Void_ *LoadPlugin()*<br>
Load the embeded html document into the browser<br>

_Void_ *FetchKml(System.String)*<br>
Wrapper for the the google.earth.fetchKml method<br>
*Parameters*<br>
string: path to a kml/kmz file<br>

_Void_ *InjectJavascript(System.String)*<br>
Inject a javascript element into the document head <br>
*Parameters*<br>
string: the script code<br>

_Object_ *InvokeJavascript(System.String)*<br>
Executes a script function defined in the currently loaded document.<br>
*Parameters*<br>
function: The name of the function to invoke<br>
*Return Value:* The result of the evaluated function<br>

_Object_ *InvokeJavascript(System.String, System._Object_[])*<br>
Executes a script function that is defined in the currently loaded document. <br>
*Parameters*<br>
string: The name of the function to invoke<br>
object[]: any arguments<br>
*Return Value:* The result of the evaluated function<br>

_Bitmap_ *ScreenGrab()*<br>
Take a 'screen grab' of the current GEWebBrowser view <br>
*Return Value:* bitmap image<br>

== Public Events ==

_GEWebBorwserEventHandeler_ *PluginReady*<br>
Raised when the plugin is ready<br>

_GEWebBorwserEventHandeler_ *KmlLoaded*<br>
Raised when a kml/kmz file has loaded<br>

_GEWebBorwserEventHandeler_ *ScriptError*<br>
Raised when there is a script error in the document <br>

== Source == 

[http://code.google.com/p/winforms-geplugin-control-library/source/browse/trunk/GEWebBrowser.cs GEWebBrowser.cs]

== Ads ==

<wiki:gadget url="http://earthapi.googlepages.com/ad.xml" border="0" width="728" height="90" />